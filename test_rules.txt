# 规则1：检测SQL注入尝试
# 子规则1: 包含常见SQL注入关键字
# 子规则2: 包含其他SQL注入特征
rule 1001 (http.uri content "select" and http.uri content "from" and http.uri content "where") or
         (http.uri content "union" and http.uri content "select" and http.uri content "*") ;

# 规则2：检测XSS攻击
# 子规则1: 包含script标签
# 子规则2: 包含其他XSS特征
rule 1002 (http.uri content "script" and http.uri content "alert") or
         (http.uri content "script" and http.uri content "eval") ;

# 规则3：检测路径遍历
# 注意这里复用了规则1中的"select"和规则2中的"script"
rule 1003 http.uri content "../" and http.uri content "select" and http.uri content "script" ;