# 基本匹配规则
rule 1001 http.uri contains "admin" ;
rule 1002 http.uri contains "Admin" /i ;
rule 1003 http.uri matches ".*\\.php$" /i /m ;
rule 1004 http.uri contains "admin" and not http.uri contains "/static/" ;
rule 1005 http.uri matches "(?:admin|manager)" /i /s ;
rule 1006 http.uri contains "download" /i /f ;
rule 1007 http.body matches "begin.*end" /m /s ;

# API 路由规则
rule 2001 http.uri matches "^/api/v[0-9]+/users/[0-9]+$" ;
rule 2002 http.uri matches "^/(?:admin|manager)/[a-zA-Z0-9_-]+/(?:edit|delete|view)$" /i ;

# 文件下载和扩展名规则
rule 2003 http.uri matches "/download/.*\\.(?:exe|dll)$" /i ;
rule 2015 http.uri matches "^/(?:admin/.*\\.php|public/.*\\.html)$" /i ;

# 多语言和Unicode支持规则
rule 2004 http.uri matches "[\\p{Han}\\p{Hiragana}\\p{Katakana}]+" /i ;
rule 2005 http.uri matches "^/(en|zh|ja)/blog/([0-9]{4})/([0-9]{2})/([^/]+)(?:\\.html)?$" /i ;
rule 2012 http.uri matches "[\\p{Han}\\p{Hiragana}\\p{Katakana}\\p{Latin}]+" /i ;

# 安全验证规则
rule 2006 http.uri matches "^(?:[A-Za-z0-9@$!%*?&]{8,})$" ;
rule 2010 http.uri matches "^/api/v[0-9]+/users/[0-9]+$" and 
         http.header matches "^Bearer\\s+[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*$" /i ;

# HTML和标签匹配规则
rule 2007 http.uri matches "<([a-z]+)>.*?</\\1>" /i /s ;

# 邮箱和URL匹配规则
rule 2008 http.uri matches "[\\w.-]+@[\\w-]+(?:\\.[\\w-]+)*\\.[A-Za-z]{2,6}" /i ;
rule 2009 http.body matches "^(?:GET|POST|PUT|DELETE)?(?:https?://)?[\\w-]+(?:\\.[\\w-]+)+[\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-]$" /i ;
rule 2014 http.body matches "[\\w-]+(?:\\.[\\w-]+)*\\.[\\w-]{2,}" /i ;

# 特殊格式匹配规则
rule 2011 http.body matches "^(?:[^()]*(?:\\([^()]*\\)[^()]*)*){0,100}$" /s ;
rule 2013 http.uri matches "^/([0-9]{4})/([0-9]{2})/([0-9]{2})/([^/]+)$" ;
